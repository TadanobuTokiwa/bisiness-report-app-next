(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[348],{7508:function(e,s,a){Promise.resolve().then(a.bind(a,1615))},1615:function(e,s,a){"use strict";a.r(s);var t=a(7437),r=a(2265),n=a(386),l=a(2381),i=a(9376),d=a(9417),c=a(5358),o=a(1245),m=a(9920),u=a(279);s.default=()=>{let[e,s]=(0,r.useState)(!1),[a,x]=(0,r.useState)(""),h=(0,i.useRouter)(),{userName:g}=(0,o.a)(),k=()=>{s(!1)};return(0,t.jsx)(m.Z,{children:(0,t.jsx)(n.zt,{store:d.h,children:(0,t.jsxs)("div",{className:"container mx-auto p-4 max-w-5xl",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,t.jsx)("h1",{className:"text-3xl font-bold",children:"業務報告"}),(0,t.jsx)("strong",{className:"border px-4 bg-yellow-600 text-white",children:"管理者用"}),(0,t.jsx)("div",{className:"flex items-center gap-4",children:(0,t.jsx)("span",{className:"text-sm text-muted-foreground",children:"ユーザー名: ".concat(g)})})]}),e?(0,t.jsx)(t.Fragment,{}):(0,t.jsx)(c.Z,{cardMoved:e,setCardMoved:s,postUserName:a}),(0,t.jsxs)("div",{className:"".concat(e?"mt-12":"mt-4"," flex justify-between"),children:[(0,t.jsxs)("div",{className:"",children:[(0,t.jsx)(u.I,{className:"w-28",value:a,onChange:e=>x(e.target.value),placeholder:"投稿ユーザー名"}),(0,t.jsx)("p",{className:"pt-1 text-xs",children:"※空欄の場合"}),(0,t.jsxs)("p",{className:"text-xs",children:[g," で投稿"]})]}),e&&(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("h2",{className:"text-2xl font-bold text-green-600",children:"送信完了"}),(0,t.jsx)("p",{className:"mt-2",children:"業務報告が正常に送信されました。"}),(0,t.jsx)(l.z,{className:"my-5 border border-blue-900 hover:bg-gray-200 z-0",onClick:()=>k(),children:"新しいカードを作成"})]}),(0,t.jsx)(l.z,{className:"border border-blue-900 hover:bg-gray-200 z-0",variant:"secondary",onClick:()=>h.back(),children:"戻る"})]})]})})})}},5358:function(e,s,a){"use strict";var t=a(7437),r=a(279),n=a(5291),l=a(1723),i=a(8930),d=a(9397),c=a(6540),o=a(4743),m=a(9820),u=a(8389),x=a(386),h=a(2381),g=a(2265),k=a(8965),f=a(1245),j=a(54);s.Z=e=>{let{cardMoved:s,setCardMoved:a,postUserName:p}=e,[N,v]=(0,g.useState)(!1),[b,w]=(0,g.useState)(!1),{tasks:y}=(0,x.v9)(e=>e.tasks),T=(0,x.I0)(),{userName:S}=(0,f.a)(),C=""===p&&S?S:p,{data:Z}=(0,j.X)(),z=Z?Z.filter(e=>e.chk):[],M=e=>{let{id:s,field:a,value:t}=e;T((0,u.xJ)({id:s,field:a,value:t}))},D=e=>{T((0,u.F6)(e))},I=()=>{T((0,u.gI)())};return(0,t.jsxs)(m.Zb,{className:"transition-all duration-500 ease-in-out bg-slate-50\n                ".concat(N?"translate-x-full opacity-0":""," \n                ").concat(s?"absolute":"","\n            "),onTransitionEnd:e=>{"transform"===e.propertyName&&(a(!0),w(!1))},children:[(0,t.jsx)(m.aY,{className:"space-y-4 pt-6",children:y.map(e=>(0,t.jsxs)("div",{className:"flex flex-col md:flex-row items-start md:items-center gap-2 p-2 rounded-md",children:[(0,t.jsxs)(n.Ph,{value:e.task,onValueChange:s=>M({id:e.id,field:"task",value:s}),children:[(0,t.jsx)(n.i4,{className:"w-full",children:(0,t.jsx)(n.ki,{placeholder:"タスクを選択"})}),(0,t.jsx)(n.Bw,{className:"bg-gray-100",children:null==z?void 0:z.map((e,s)=>(0,t.jsx)(n.Ql,{value:String(e.id),style:{backgroundColor:e.color},children:e.taskName},s))})]}),(0,t.jsxs)("div",{className:"flex flex-wrap md:flex-nowrap justify-around gap-2 w-full md:w-3/4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 md:w-auto",children:[(0,t.jsx)(l.Z,{className:"w-4 h-4 text-muted-foreground"}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(r.I,{type:"time",value:e.startTime,onChange:s=>M({id:e.id,field:"startTime",value:s.target.value}),className:"w-24"}),(0,t.jsx)("span",{children:"~"}),(0,t.jsx)(r.I,{type:"time",value:e.endTime,onChange:s=>M({id:e.id,field:"endTime",value:s.target.value}),className:"w-24"})]})]}),(0,t.jsx)(r.I,{type:"number",value:e.kensu,onChange:s=>M({id:e.id,field:"kensu",value:s.target.value}),className:"w-20",min:0}),(0,t.jsx)(h.z,{variant:"ghost",className:"border rounded-xl hover:bg-gray-200",size:"icon",onClick:()=>b?console.log("送信中です"):D(e.id),children:(0,t.jsx)(i.Z,{className:"w-4 h-4"})})]})]},e.id))}),(0,t.jsxs)(m.eW,{className:"flex justify-between",children:[(0,t.jsxs)(h.z,{variant:"outline",className:"hover:bg-gray-200",onClick:()=>b?console.log("送信中です"):I(),children:[(0,t.jsx)(d.Z,{className:"w-4 h-4 mr-2"}),"追加"]}),b?(0,t.jsxs)(h.z,{className:"border border-black text-white bg-sky-700 hover:bg-sky-700",children:[(0,t.jsx)(c.Z,{className:"w-4 h-4 mr-2 animate-spin"}),"送信中..."]}):(0,t.jsxs)(h.z,{className:"border border-black text-white bg-sky-700 hover:bg-sky-800",onClick:()=>{let e=y.filter(e=>e.startTime>=e.endTime),s=y.filter(e=>""===e.task);if(e.length+s.length!==0){window.alert("入力内容を確認してください");return}if(!S){window.alert("ユーザー情報を確認してください");return}w(!0);try{y.map(async e=>{let s=new Date("2024-03-01 "+e.startTime+":00"),a=new Date("2024-03-01 "+e.endTime+":00").getTime()-s.getTime(),t=new Date,r=0===e.kensu?0:Math.floor(e.kensu/(a/36e5)*100)/100,n={createDate:t.getFullYear()+"-"+String(t.getMonth()+1).padStart(2,"0")+"-"+String(t.getDate()).padStart(2,"0"),task:e.task,startTime:e.startTime,endTime:e.endTime,kensu:e.kensu,User:C,workingHour:Math.floor(a/36e5*1e3)/1e3,perHour:r,DateTimeNum:Number(String(t.getFullYear())+String(t.getMonth()+1).padStart(2,"0")+String(t.getDate()).padStart(2,"0")+String(e.startTime.replaceAll(":","")))};await (0,k.jX)(n),v(!0),T((0,u.KP)())})}catch(e){window.alert("エラーが発生しました"),w(!1)}},children:[(0,t.jsx)(o.Z,{className:"w-4 h-4 mr-2"}),"送信"]})]})]})}},8389:function(e,s,a){"use strict";a.d(s,{F6:function(){return n},KP:function(){return i},gI:function(){return r},xJ:function(){return l}});let t=(0,a(1455).oM)({name:"taskFrom",initialState:{tasks:[{id:1,task:"",startTime:"09:00",endTime:"09:00",kensu:0}]},reducers:{addTask:e=>{let s=e.tasks[e.tasks.length-1].endTime;e.tasks.push({id:Math.floor(1e7*Math.random()),task:"",startTime:s,endTime:s,kensu:0})},removeTask:(e,s)=>{1!==e.tasks.length&&(e.tasks=e.tasks.filter(e=>e.id!==s.payload))},updateTask:(e,s)=>{e.tasks=e.tasks.map(e=>e.id===s.payload.id?{...e,[s.payload.field]:s.payload.value}:e)},resetTask:e=>{e.tasks=[{id:1,task:"",startTime:"09:00",endTime:"09:00",kensu:0}]}}}),{addTask:r,removeTask:n,updateTask:l,resetTask:i}=t.actions;s.ZP=t.reducer},9417:function(e,s,a){"use strict";a.d(s,{h:function(){return n}});var t=a(1455),r=a(8389);let n=(0,t.xC)({reducer:{tasks:r.ZP}})}},function(e){e.O(0,[387,358,146,82,929,763,415,632,150,971,117,744],function(){return e(e.s=7508)}),_N_E=e.O()}]);
(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[460],{202:function(e,s,a){Promise.resolve().then(a.bind(a,4017))},4017:function(e,s,a){"use strict";a.r(s);var t=a(7437),r=a(2265),n=a(386),l=a(2381),i=a(7648),d=a(9376),c=a(9417),o=a(5358),m=a(4752),u=a(8150),h=a(4131),x=a(1245),g=a(9920);s.default=()=>{let[e,s]=(0,r.useState)(!1),a=(0,d.useRouter)(),{userName:f}=(0,x.a)(),k=()=>{s(!1)},j=async()=>{await (0,m.w7)(u.I),h.Z.remove("__session"),a.push("/login")};return(0,t.jsx)(g.Z,{children:(0,t.jsx)(n.zt,{store:c.h,children:(0,t.jsxs)("div",{className:"container mx-auto p-4 max-w-5xl",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,t.jsx)("h1",{className:"text-3xl font-bold",children:"業務報告"}),(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsx)("span",{className:"text-sm text-muted-foreground",children:"ユーザー名: ".concat(f)}),(0,t.jsx)(l.z,{className:"hover:bg-gray-200",variant:"outline",size:"sm",onClick:()=>j(),children:"ログアウト"})]})]}),e?(0,t.jsx)(t.Fragment,{}):(0,t.jsx)(o.Z,{cardMoved:e,setCardMoved:s,postUserName:""}),(0,t.jsxs)("div",{className:"".concat(e?"mt-12":"mt-4"," flex justify-between"),children:[(0,t.jsx)("div",{className:"invisible"}),e&&(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("h2",{className:"text-2xl font-bold text-green-600",children:"送信完了"}),(0,t.jsx)("p",{className:"mt-2",children:"業務報告が正常に送信されました。"}),(0,t.jsx)(l.z,{className:"my-5 border border-blue-900 hover:bg-gray-200 z-0",onClick:()=>k(),children:"新しいカードを作成"})]}),(0,t.jsx)(l.z,{className:"border border-blue-900 hover:bg-gray-200 z-0",variant:"secondary",children:(0,t.jsx)(i.default,{href:"/general/sendlist",children:"リスト表示"})})]})]})})})}},5358:function(e,s,a){"use strict";var t=a(7437),r=a(279),n=a(5291),l=a(1723),i=a(8930),d=a(9397),c=a(6540),o=a(4743),m=a(9820),u=a(8389),h=a(386),x=a(2381),g=a(2265),f=a(8965),k=a(1245),j=a(54);s.Z=e=>{let{cardMoved:s,setCardMoved:a,postUserName:v}=e,[p,N]=(0,g.useState)(!1),[b,w]=(0,g.useState)(!1),{tasks:y}=(0,h.v9)(e=>e.tasks),T=(0,h.I0)(),{userName:S}=(0,k.a)(),C=""===v&&S?S:v,{data:z}=(0,j.X)(),Z=z?z.filter(e=>e.chk):[],M=e=>{let{id:s,field:a,value:t}=e;T((0,u.xJ)({id:s,field:a,value:t}))},_=e=>{T((0,u.F6)(e))},D=()=>{T((0,u.gI)())};return(0,t.jsxs)(m.Zb,{className:"transition-all duration-500 ease-in-out bg-slate-50\n                ".concat(p?"translate-x-full opacity-0":""," \n                ").concat(s?"absolute":"","\n            "),onTransitionEnd:e=>{"transform"===e.propertyName&&(a(!0),w(!1))},children:[(0,t.jsx)(m.aY,{className:"space-y-4 pt-6",children:y.map(e=>(0,t.jsxs)("div",{className:"flex flex-col md:flex-row items-start md:items-center gap-2 p-2 rounded-md",children:[(0,t.jsxs)(n.Ph,{value:e.task,onValueChange:s=>M({id:e.id,field:"task",value:s}),children:[(0,t.jsx)(n.i4,{className:"w-full",children:(0,t.jsx)(n.ki,{placeholder:"タスクを選択"})}),(0,t.jsx)(n.Bw,{className:"bg-gray-100",children:null==Z?void 0:Z.map((e,s)=>(0,t.jsx)(n.Ql,{value:String(e.id),style:{backgroundColor:e.color},children:e.taskName},s))})]}),(0,t.jsxs)("div",{className:"flex flex-wrap md:flex-nowrap justify-around gap-2 w-full md:w-3/4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 md:w-auto",children:[(0,t.jsx)(l.Z,{className:"w-4 h-4 text-muted-foreground"}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(r.I,{type:"time",value:e.startTime,onChange:s=>M({id:e.id,field:"startTime",value:s.target.value}),className:"w-24"}),(0,t.jsx)("span",{children:"~"}),(0,t.jsx)(r.I,{type:"time",value:e.endTime,onChange:s=>M({id:e.id,field:"endTime",value:s.target.value}),className:"w-24"})]})]}),(0,t.jsx)(r.I,{type:"number",value:e.kensu,onChange:s=>M({id:e.id,field:"kensu",value:s.target.value}),className:"w-20",min:0}),(0,t.jsx)(x.z,{variant:"ghost",className:"border rounded-xl hover:bg-gray-200",size:"icon",onClick:()=>b?console.log("送信中です"):_(e.id),children:(0,t.jsx)(i.Z,{className:"w-4 h-4"})})]})]},e.id))}),(0,t.jsxs)(m.eW,{className:"flex justify-between",children:[(0,t.jsxs)(x.z,{variant:"outline",className:"hover:bg-gray-200",onClick:()=>b?console.log("送信中です"):D(),children:[(0,t.jsx)(d.Z,{className:"w-4 h-4 mr-2"}),"追加"]}),b?(0,t.jsxs)(x.z,{className:"border border-black text-white bg-sky-700 hover:bg-sky-700",children:[(0,t.jsx)(c.Z,{className:"w-4 h-4 mr-2 animate-spin"}),"送信中..."]}):(0,t.jsxs)(x.z,{className:"border border-black text-white bg-sky-700 hover:bg-sky-800",onClick:()=>{let e=y.filter(e=>e.startTime>=e.endTime),s=y.filter(e=>""===e.task);if(e.length+s.length!==0){window.alert("入力内容を確認してください");return}if(!S){window.alert("ユーザー情報を確認してください");return}w(!0);try{y.map(async e=>{let s=new Date("2024-03-01 "+e.startTime+":00"),a=new Date("2024-03-01 "+e.endTime+":00").getTime()-s.getTime(),t=new Date,r=0===e.kensu?0:Math.floor(e.kensu/(a/36e5)*100)/100,n={createDate:t.getFullYear()+"-"+String(t.getMonth()+1).padStart(2,"0")+"-"+String(t.getDate()).padStart(2,"0"),task:e.task,startTime:e.startTime,endTime:e.endTime,kensu:e.kensu,User:C,workingHour:Math.floor(a/36e5*1e3)/1e3,perHour:r,DateTimeNum:Number(String(t.getFullYear())+String(t.getMonth()+1).padStart(2,"0")+String(t.getDate()).padStart(2,"0")+String(e.startTime.replaceAll(":","")))};await (0,f.jX)(n),N(!0),T((0,u.KP)())})}catch(e){window.alert("エラーが発生しました"),w(!1)}},children:[(0,t.jsx)(o.Z,{className:"w-4 h-4 mr-2"}),"送信"]})]})]})}},8389:function(e,s,a){"use strict";a.d(s,{F6:function(){return n},KP:function(){return i},gI:function(){return r},xJ:function(){return l}});let t=(0,a(1455).oM)({name:"taskFrom",initialState:{tasks:[{id:1,task:"",startTime:"09:00",endTime:"09:00",kensu:0}]},reducers:{addTask:e=>{let s=e.tasks[e.tasks.length-1].endTime;e.tasks.push({id:Math.floor(1e7*Math.random()),task:"",startTime:s,endTime:s,kensu:0})},removeTask:(e,s)=>{1!==e.tasks.length&&(e.tasks=e.tasks.filter(e=>e.id!==s.payload))},updateTask:(e,s)=>{e.tasks=e.tasks.map(e=>e.id===s.payload.id?{...e,[s.payload.field]:s.payload.value}:e)},resetTask:e=>{e.tasks=[{id:1,task:"",startTime:"09:00",endTime:"09:00",kensu:0}]}}}),{addTask:r,removeTask:n,updateTask:l,resetTask:i}=t.actions;s.ZP=t.reducer},9417:function(e,s,a){"use strict";a.d(s,{h:function(){return n}});var t=a(1455),r=a(8389);let n=(0,t.xC)({reducer:{tasks:r.ZP}})}},function(e){e.O(0,[387,358,146,82,929,763,415,632,648,150,971,117,744],function(){return e(e.s=202)}),_N_E=e.O()}]);